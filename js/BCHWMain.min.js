(function(a){function b(){this.margin=0.1}b.REFRESH_AFTER_RESIZE_INTERVAL=300;b.RENDER_CHARACTER_INTERVAL=30;b.MAX_WIDTH=800;b.MAX_HEIGHT=600;b.prototype.init=function(c){console.log("BCHWMain.init()");this.canvas=document.createElement("canvas");this.demoContainer=c;this.context=this.canvas.getContext("2d");this.context.lineCap="round";c.appendChild(this.canvas);this.createLogo();this.render()};b.prototype.clearContext=function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)};b.prototype.resizeHandler=function(){this.clearContext();clearTimeout(this.renderTimeoutId);clearTimeout(this.renderCharactersTimeoutId);var c=this;this.renderTimeoutId=setTimeout(function(){c.render()},b.REFRESH_AFTER_RESIZE_INTERVAL)};b.prototype.render=function(){this.canvas.width=this.demoContainer.clientWidth;this.canvas.height=this.demoContainer.clientHeight;this.clearContext();this.renderLogo()};b.prototype.renderBG=function(){this.context.fillStyle=BCHWColor.BCHWColorsLib.TURQUOISE.getCanvasColorString();this.context.fillRect(0,0,this.canvas.width,this.canvas.height)};b.prototype.createLogo=function(c,d){this.row1=new BCHWFontLayoutRow();this.setRowManagerText(this.row1,"big city");this.row2=new BCHWFontLayoutRow();this.setRowManagerText(this.row2,"house wife")};b.prototype.setRowManagerText=function(e,j){var h=BCHWColor.BCHWColorsLib.WHITE;var g,c,d,f;for(d=0;d<j.length;d++){g=j.charAt(d);c=BCHWColor.BCHWColorsLib.getNextColor(c);f=BCHWFontCharacter.createBCHWFontCharacter(g,c,h,4,new BCHWGeom.RoundedRectangle());if(g==" "){f.width=0.5}e.addCharacter(f)}};b.prototype.renderCharacters=function(){this.zIndeces=BCHWArrayUtil.createSequentialNumericArray(this.allCharacters.length);this.zIndeces=BCHWArrayUtil.shuffle(this.zIndeces);this.currentRenderIndex=0;this.renderNextCharacter()};b.prototype.renderNextCharacter=function(){if(this.currentRenderIndex==this.allCharacters.length){return}fontCharacter=this.allCharacters[this.zIndeces[this.currentRenderIndex]];fontCharacter.addRandomness(2,0.01);fontCharacter.renderToContext(this.context);var c=this;this.renderCharactersTimeoutId=setTimeout(function(){c.renderNextCharacter()},b.RENDER_CHARACTER_INTERVAL);this.currentRenderIndex++};b.prototype.renderLogo=function(){var f=this.canvas.width*this.margin;var e=this.canvas.height*this.margin;var d=BCHWGeom.createRectangle(f,e,this.canvas.width-f*2,this.canvas.height-e*2);var c=BCHWGeom.RectangleUtil.getBiggerRectangle(this.row1.getSampleRect(100),this.row2.getSampleRect(100));BCHWGeom.RectangleUtil.scaleRectToBestFit(d,c);BCHWGeom.RectangleUtil.horizontalAlignMiddle(d,c);c.y=BCHWGeom.RectangleUtil.getCenterY(d)-c.height;this.row1.layoutRectangle=c;this.row1.layoutCharacters();c.y=BCHWGeom.RectangleUtil.getCenterY(d);this.row2.layoutRectangle=c;this.row2.layoutCharacters();this.allCharacters=this.row1.characters.concat(this.row2.characters);this.renderCharacters()};a.BCHWMain=b}(window));